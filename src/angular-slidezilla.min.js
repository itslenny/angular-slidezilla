"use strict";angular.module("angular-slidezilla",[]).constant("angularSlidezillaConfig",{min:0,max:100,step:5}).controller("AngularSlidezillaController",["angularSlidezillaConfig","$scope",function(e,n){n.min=e.min||0,n.max=e.max||100,n.step=e.step||5}]).directive("slider",function(){return{scope:{model:"=ngModel"},restrict:"E",require:["ngModel"],controller:"AngularSlidezillaController",link:function(i,e,n,r){n.min&&(i.min=i.$parent.$eval(n.min),i.$parent.$watch(n.min,function(e){i.min=e,r[0].$render()})),n.max&&(i.max=i.$parent.$eval(n.max),i.$parent.$watch(n.max,function(e){i.max=e,r[0].$render()})),n.step&&(i.step=i.$parent.$eval(n.step),i.$parent.$watch(n.step,function(e){i.step=e,r[0].$render()}));var l=e[0].querySelectorAll(".slider-handle"),a=e[0].querySelector(".slider-track"),o=e[0].querySelector(".slider-selection"),m=!1;function t(e){if(m){m.y=e.clientY-m.sy,m.x=e.clientX-m.sx,m.x<0?m.x=0:m.x>m.container.right-m.container.left&&(m.x=m.container.right-m.container.left);var n=Math.max(0,Math.min(100,parseInt(m.x/(m.container.right-m.container.left)*100)))/100*(i.max-i.min)+i.min;n=parseFloat(n.toFixed(3));var t,l,a=(t=n,l=i.step,0<=t?t+l/2-(t+l/2)%l:t-l/2-(t+l/2)%l);i.$apply(function(){var e=i.model;"number"==typeof e?e=a:e[m.index]=a,i.model=e,r[0].$render()})}}function d(e){angular.element(document).unbind("mousemove",t),angular.element(document).unbind("mouseup",d),m=!1}r[0].$render=function(){var e,n;!function(){if(!i.model)return i.model=i.min;if("number"==typeof i.model)i.model>i.max?i.model=i.max:i.model<i.min&&(i.model=i.min);else{var e,n;i.model[0]>i.model[1]&&(n=i.model[0],e=i.model[1],i.model[0]=e,i.model[1]=n),i.model[0]>i.max?e=i.max:i.model[0]<i.min&&(e=i.min),i.model[1]>i.max?n=i.max:i.model[1]<i.min&&(n=i.min),(e||n)&&(i.model=[e||i.model[0],n||i.model[1]])}}(),r[0].$setViewValue(i.model),"number"==typeof i.model?(e=0,n=100/(i.max-i.min)*(i.model-i.max)+100,angular.element(l[0]).css("margin-left",n+"%"),angular.element(l[1]).addClass("hidden")):(e=100/(i.max-i.min)*(i.model[0]-i.max)+100,n=100/(i.max-i.min)*(i.model[1]-i.max)+100,angular.element(l[0]).css("margin-left",e+"%"),angular.element(l[1]).css("margin-left",n+"%").removeClass("hidden")),angular.element(o).css("margin-left",e+"%").css("width",n-e+1+"%")},angular.element(a).bind("mousedown",function(e){if(e.preventDefault(),!m){var n=i.model,t=e.offsetX||e.layerX;"number"==typeof n?t>l[0].offsetLeft?n+=i.step:n-=i.step:e.target==a&&t<l[0].offsetLeft?n[0]-=i.step:e.target==a&&t>l[1].offsetLeft?n[1]+=i.step:e.target==o&&t>e.target.offsetWidth/2?n[1]-=i.step:n[0]+=i.step,i.$apply(function(){i.model=n,r[0].$render()})}}),angular.element(l).bind("mousedown",function(e){e.preventDefault(),m={sx:e.clientX-e.target.offsetLeft,sy:e.clientY-e.target.offsetTop,w:e.target.offsetWidth,h:e.target.offsetHeight,element:e.target,index:e.target==l[0]?0:1,container:e.target.parentElement.getBoundingClientRect()},angular.element(document).bind("mousemove",t),angular.element(document).bind("mouseup",d)})},template:'<div class="slider slider-horizontal"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle round"></div><div class="slider-handle round"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><input type="text" class="slider"></div></div>',replace:!0}});